import hashlib
import os
from os.path import basename
import glob
import sys
def md5(fname):
    hash_md5 = hashlib.md5()
    with open(fname, "rb") as f:
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

def sha256(filename):
  h = hashlib.sha256()
  with open(filename, 'rb', buffering=0) as f:
    for b in iter(lambda : f.read(128*1024), b''):
      h.update(b)
  return h.hexdigest()

def filesToSha256(folder):
    files = [os.path.join(folder,fi) for fi in os.listdir(folder)]
    for fil in files:
        fileBasename = basename(fil)
        fullPath = folder+"/"+fileBasename
        shaFile = sha256(fullPath)
        print("Filename: ",fileBasename, " sha256: ",shaFile)
        os.rename(fullPath, folder+"/"+shaFile)

if __name__ == "__main__":
    folder = sys.argv[1] # malware folder
    print("Path folder: ", sys.argv[1])
    filesToSha256(folder)
